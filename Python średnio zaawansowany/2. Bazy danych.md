### 2.1 Wstęp do baz danych i podstawy SQL
### Czym jest baza danych?
Relacyjna baza danych to model przechowywania danych, w którym dane te zorganizowane są w tabelach (zwanych również relacjami). Tabele posiadają wiersze i kolumny. Wiersze reprezentują rekordy (obserwacje) przechowywane w bazie, a kolumny odnoszą się do ich cech (atrybutów).

W praktyce można myśleć o bazie danych jak o zbiorze tabel. Aby dostać się do pojedynczej informacji należy określić nazwę tabeli, nazwę kolumny oraz tzw. klucz główny.

![[table.png]]


**Structured Query Language - ustrukturyzowany język zapytań**

Do wykonywania operacji na relacyjnej bazie danych służy język SQL. Kod SQLa to tak zwane zapytania (*queries*). Różne typy zapytań pozwalają wykonać różne operacje:

- CREATE - do tworzenia tabeli
- INSERT - do tworzenia nowych wierszy
- SELECT - do wyciągania danych z tabeli
- UPDATE - do edycji istniejących danych
- DELETE - do usuwania danych
- DROP - do usuwania tabel / baz danych


### **CREATE**

To zapytanie służy do tworzenia tabel. Poniższy kod utworzy tabelę przechowującą informacje o samochodach.

``` SQL
CREATE TABLE cars (
    id          SMALLINT,    
    brand       VARCHAR(20), 
    price       NUMERIC,     
    fuel_type   TEXT,      
    mileage     NUMERIC,
    is_new      BOOLEAN,  
    prod_date   DATE 
);
```

Jego kluczowym elementem jest zdefiniowanie poszczególnych kolumn poprzez podanie ich nazwy oraz typu danych.


### **INSERT** 

Tym zapytanie dodajemy dane do tabeli, a ściślej – tworzymy nowy wiersz. Możemy, ale nie musimy określać wartości dla każdej kolumny. Jeśli chcemy dodać kompletny wiersz, robimy to w taki sposób:

```sql
INSERT INTO cars
VALUES (1, 'Audi', 80000, 'Benzyna', 200000, True, '2015-09-12');
```

A jeśli tylko dla wybranych kolumn:
```sql
INSERT INTO cars (brand, price)
VALUES ('Volvo', 90000);
```

Wówczas wartości w pozostałych kolumnach będą puste (NULL).

### **SELECT**

Jest to prawdopodobnie najczęściej używane zapytanie w języku SQL. Służy do wyciągania danych z bazy.

**Przykłady zapytań typu SELECT**

``` SQL
SELECT * FROM cars; 

SELECT brand, price, mileage FROM cars; 

SELECT * FROM cars
WHERE price > 50000 and is_new='False';

SELECT * FROM cars
WHERE price > 50000
ORDER BY mileage;
```


### UPDATE
W celu zmodyfikowania już istniejącej w tabeli wartości, korzystamy z zapytania UPDATE.

```SQL
UPDATE cars SET brand = 'Opel' WHERE mileage > 150000;
```

Jeśli nie określimy warunku, zmodyfikowana zostanie cała kolumna.

```SQL
UPDATE cars SET (mileage, is_new) = (1000, 'False') WHERE id = 4;
```

### DELETE
DELETE służy do usunięcia rekordów z tabeli.

```SQL
DELETE FROM cars WHERE is_new = False
```

Tutaj również należy określić warunek, w innym wypadku usunięte zostaną wszystkie wiersze.

### DROP

DROP pozwala usunąć całą tabelę albo bazę danych.

```SQL
DROP TABLE cars
```



---
---
---
&nbsp;
### 2.2 PostgreSQL + Python
Aby połączyć się w Pythonie z bazą danych PostgreSQL i wykonywać na niej operacje, należy zaimportować bibliotekę `psycopg2` a następnie utworzyć obiekt typu `connection`:

```python
import psycopg2

dbname = "postgres"
user = "postgres"
password = "postgres"
host = "localhots"
port = 5432

conn = psycopg2.connect(dbname=dbname, user=user, password=password, host=host, port=port)
```

Następnie wykorzystując połączenie tworzymy kursor:

```python
cursor = conn.cursor()
```

W tym miejscu następują operacje na bazie danych, po których możemy zamknąć połączenie i kursor:

```python
conn.close()
cursor.close()
```


---

Aby wykonać operacje, które tworzą lub modyfikują dane w bazie, takie jak m.in.:
- CREATE
- INSERT
- UPDATE
- DELETE
- DROP

używamy następującego schematu:


1. Stworzenie połączenia oraz kursora
```python
conn = psycopg2.connect(dbname=dbname, user=user, password=password, host=host, port=port)
cursor = conn.cursor()
```

2. Wykonanie zapytania (`execute` + `commit`)
```python
create_query = '''
CREATE TABLE cars (
    id          SMALLINT, 
    brand       VARCHAR(20),
    price       NUMERIC,    
    fuel_type   TEXT,     
    mileage     NUMERIC,
    is_new      BOOLEAN,  
    prod_date   DATE   
);
'''

cursor.execute(create_query)
conn.commit()
```

3. Zamknięcie połączenia i kursora

```python
conn.close()
cursor.close()
```

W celu wykonania zapytania typu SELECT, które wyciąga dane z bazy, należy zmodyfikować punkt 2 powyższego schematu:

```python
select_query = "SELECT * FROM cars"

cursor.execute(select_query)
results = cursor.fetchall()
```

Zamiast commitować wykonaną operację, pobieramy jej wynik (`fetchall`), który przechwytujemy w postaci listy tupli. Każdej tupli w liście odpowiada pojedynczy wiersz tabeli.

---




---
---
---
&nbsp;
### 2.3 SQLAlchemy

---
---
---
&nbsp;
### 2.4 MongoDB

---
---
---
&nbsp;
